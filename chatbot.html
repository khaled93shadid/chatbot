<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>chatbot</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/chatbot.css" />
</head>
<body>
  <div class="js-container ">  </div>


  <script src="https://unpkg.com/supersimpledev/react.js"></script>
  <script src="https://unpkg.com/supersimpledev/react-dom.js"></script>
  <script src="https://unpkg.com/supersimpledev/chatbot.js"></script>
  <script src="https://unpkg.com/supersimpledev/babel.js"></script>
  <script type="text/babel"> 

      function ChatInput({chatMessages,setChatMessages}){
        const [inputText,setInputText]=React.useState('');
         function saveInputText(event){
         setInputText(event.target.value)
         
         }
        function sendMessage(){
          const newChatMessages =[...chatMessages,{ message:inputText , sender:'user', id:crypto.randomUUID() }]
           setChatMessages(newChatMessages)
           const response= Chatbot.getResponse(inputText)
           setChatMessages([...newChatMessages,{ message:response , sender:'robot', id:crypto.randomUUID() }])
           setInputText('')
        }
            return(
                <div className="input_flex">
                  <input className='input_chatbot' onChange={saveInputText} placeholder="Send a message to chatbot" size="30" value={inputText}/>
                  <button className='button_chatbot' onClick={sendMessage}> send</button>
              </div>

            ) }//chat input end
      function ChatMessage({message,sender}){
              //const message=props.message;
              //const sender =props.sender;
              /*
              if(sender==='robot'){

                    return(
                    <div>
                        <img src="https://supersimple.dev/projects/chatbot/robot.png" width="50" /> 
                      {message}
                    
                  </div>

               )
             
              }
                */
            return(
                <div>
                   {sender==='robot'&&<div><img src="https://supersimple.dev/projects/chatbot/robot.png" width="50" /> 
                    <p className="message_p"> {message}</p>
                    </div>}
                   
                 
                  {sender==='user'&& <div className="div_user"> 
                     
                      <p className="message_p"> {message}</p>
                       <img className='user_img' src="https://supersimple.dev/projects/chatbot/user.png" width="50" /> 
                    </div>}
              </div>

            )}   
            
       function ChatMessages({chatMessages,setChatMessages}){
         const chatMessagesRef = React.useRef(null)
         React.useEffect(()=>{
             const containerElem=chatMessagesRef.current
             if(containerElem){containerElem.scrollTop=containerElem.scrollHeight }   
         },[chatMessages])
       

        return(
          <div className="chatMessages"   ref={chatMessagesRef}>
          
                {chatMessages? chatMessages.map((chatMessage)=>{
              return( <ChatMessage message={chatMessage.message} sender={chatMessage.sender} key={chatMessage.id} /> )
           }):<p className="welcome_msg">Welcome to the chatbot project! Send a message using the textbox above.</p> }
          </div>
        )
       }  //chatMessages end   


      function App(){
       const [chatMessages,setChatMessages] =React.useState([])
 
        return(
         
          <div className="bodyDiv_chatbot">
          
           <ChatMessages  chatMessages={chatMessages} setChatMessages={setChatMessages} />
            <ChatInput chatMessages={chatMessages} setChatMessages={setChatMessages} />
           </div>
         
          
        )
      } 
            
     const app =(
      <> 
           <ChatInput />
           <ChatMessage message="hello chatbot" sender="user" />
           <ChatMessage message="Hello! How can I help you?" sender="robot" />
           <ChatMessage message="can you get me todays date"  sender="user" />
           <ChatMessage message="today is september 27"  sender="robot" />
           <ChatMessage message="how about flip a coin"  sender="user" />
           <ChatMessage message="sure you got tails" sender="robot" />

      </> );
const container= document.querySelector('.js-container');
ReactDOM.createRoot(container).render(<App/> )
  </script>
</body>
</html>